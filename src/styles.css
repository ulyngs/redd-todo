/* Reset and base styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    /* Backgrounds */
    --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --app-bg: #f0f4f8;
    --app-bg-solid: #f0f4f8;
    --task-bg: rgba(255, 255, 255, 0.8);
    --hover-bg: rgba(0, 0, 0, 0.05);
    --active-bg: rgba(0, 0, 0, 0.08);
    --input-bg: transparent;
    --modal-bg: white;

    /* Text */
    --text-primary: #333333;
    --text-secondary: #666666;
    --text-tertiary: #999999;
    --text-inverse: #ffffff;

    /* Borders */
    --border-color: rgba(0, 0, 0, 0.05);
    --border-color-medium: rgba(0, 0, 0, 0.1);
    --border-color-strong: rgba(0, 0, 0, 0.2);

    /* Accents */
    --accent-primary: #667eea;
    --accent-hover: #5a6fd6;
    --focus-btn-bg: hsl(222.2, 84%, 4.9%);
    --focus-btn-text: hsl(210, 40%, 98%);

    /* Status */
    --danger: #ef4444;
    --success: #2ecc71;
    --warning: #f59e0b;

    /* Navigation */
    --nav-item-text: rgba(0, 0, 0, 0.5);
    --nav-item-hover-bg: rgba(255, 255, 255, 0.2);
    --nav-item-hover-text: rgba(0, 0, 0, 0.8);
}

[data-theme="dark"] {
    /* Backgrounds */
    --bg-gradient: linear-gradient(135deg, #09090b 0%, #18181b 100%);
    /* Zinc 950 -> 900 */
    --app-bg: rgba(24, 24, 27, 0.95);
    /* Zinc 900 */
    --app-bg-solid: #18181b;
    --task-bg: rgba(39, 39, 42, 0.6);
    /* Zinc 800 */
    --hover-bg: rgba(255, 255, 255, 0.05);
    --active-bg: rgba(255, 255, 255, 0.1);
    --input-bg: rgba(0, 0, 0, 0.2);
    --modal-bg: #18181b;
    /* Zinc 900 */

    /* Text */
    --text-primary: #fafafa;
    /* Zinc 50 */
    --text-secondary: #a1a1aa;
    /* Zinc 400 */
    --text-tertiary: #71717a;
    /* Zinc 500 */
    --text-inverse: #09090b;

    /* Borders */
    --border-color: rgba(255, 255, 255, 0.1);
    --border-color-medium: rgba(255, 255, 255, 0.15);
    --border-color-strong: rgba(255, 255, 255, 0.25);

    /* Accents */
    --accent-primary: #3b82f6;
    /* Blue 500 - Professional blue, readable */
    --accent-hover: #60a5fa;
    --focus-btn-bg: #fafafa;
    /* White focus button in dark mode for contrast */
    --focus-btn-text: #18181b;

    /* Navigation */
    --nav-item-text: #a1a1aa;
    --nav-item-hover-bg: rgba(255, 255, 255, 0.1);
    --nav-item-hover-text: #ffffff;
}

/* Quill editor dark mode overrides */
[data-theme="dark"] .ql-snow .ql-stroke {
    stroke: #a1a1aa;
}

[data-theme="dark"] .ql-snow .ql-stroke-miter {
    stroke: #a1a1aa;
}

[data-theme="dark"] .ql-snow .ql-fill,
[data-theme="dark"] .ql-snow .ql-stroke.ql-fill {
    fill: #a1a1aa;
}

[data-theme="dark"] .ql-snow .ql-picker {
    color: #a1a1aa;
}

/* Hover/active states for dark mode */
[data-theme="dark"] .ql-snow.ql-toolbar button:hover .ql-stroke,
[data-theme="dark"] .ql-snow.ql-toolbar button:focus .ql-stroke,
[data-theme="dark"] .ql-snow.ql-toolbar button.ql-active .ql-stroke {
    stroke: #3b82f6;
}

[data-theme="dark"] .ql-snow.ql-toolbar button:hover .ql-fill,
[data-theme="dark"] .ql-snow.ql-toolbar button:focus .ql-fill,
[data-theme="dark"] .ql-snow.ql-toolbar button.ql-active .ql-fill,
[data-theme="dark"] .ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill,
[data-theme="dark"] .ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,
[data-theme="dark"] .ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill {
    fill: #3b82f6;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: var(--app-bg-solid);
    color: var(--text-primary);
    overflow: hidden;
}

/* App Container */
.app-container {
    width: 100vw;
    height: 100vh;
    display: flex;
    flex-direction: column;
    background: var(--app-bg);
    backdrop-filter: blur(10px);
    border-radius: 8px;
    box-shadow: none;
    padding: 0px 8px 30px 8px;
    /* Added some top padding */
    /* Space for fixed footer */
    overflow: hidden;
    /* Prevent app-wide scroll */
}

/* Normal Mode UI wrapper */
#normal-mode {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
}

/* Title Bar */
.title-bar {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 6px 16px 12px 16px;
    background: transparent;
    -webkit-app-region: drag;
    cursor: move;
    position: relative;
    flex-shrink: 0;
}

.title {
    display: none;
}

/* View Switcher */
.view-switcher {
    display: flex;
    align-items: center;
    background: transparent;
    /* Removed background */
    border-radius: 6px;
    padding: 2px;
    margin: 0;
    /* Centered by flex parent */
    -webkit-app-region: no-drag;
}

.view-btn {
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-tertiary);
    /* Lighter gray for inactive state */
    transition: all 0.2s ease;
    padding: 0;
    outline: none;
}

.view-btn:focus {
    outline: none;
}

.view-btn:hover {
    color: var(--text-secondary);
    background: transparent;
    /* Removed hover background */
}

.view-btn.active {
    background: transparent;
    /* Removed active background */
    color: var(--text-primary);
    box-shadow: none;
    /* Removed active shadow */
}

/* Ensure heart is always filled in switch, adjusting opacity or color if needed */
#view-fav-btn svg {
    fill: currentColor;
}

/* Window Controls */
.window-controls {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
    display: flex;
    align-items: center;
    -webkit-app-region: no-drag;
}

.win-btn {
    width: 46px;
    height: 100%;
    /* Fill the title bar height */
    min-height: 40px;
    /* Fallback */
    border: none;
    background: transparent;
    display: flex;
    justify-content: center;
    align-items: center;
    color: var(--text-secondary);
    cursor: default;
    transition: background 0.1s;
}

.win-btn:hover {
    background: var(--hover-bg);
    color: var(--text-primary);
}

.win-btn.close-btn:hover {
    background: #e81123;
    color: white;
}


/* Groups Container */
.groups-container {
    display: flex;
    align-items: center;
    padding: 0px 16px 0 16px;
    background: transparent;
    /* border-bottom: 1px solid rgba(0, 0, 0, 0.05); */
}

.groups {
    display: flex;
    flex: 1;
    gap: 4px;
    overflow-x: auto;
    align-items: center;
}

.group-tab {
    padding: 4px 10px;
    background: transparent;
    border-radius: 4px;
    cursor: pointer;
    font-size: 11px;
    font-weight: 600;
    white-space: nowrap;
    transition: all 0.15s ease;
    color: var(--nav-item-text);
    -webkit-app-region: no-drag;
    display: flex;
    align-items: center;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.group-tab:hover {
    background: var(--nav-item-hover-bg);
    color: var(--nav-item-hover-text);
}

.group-tab.active {
    background: var(--app-bg-solid);
    color: var(--text-primary);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.group-tab.dimmed {
    opacity: 0.5;
    filter: saturate(0.6) brightness(0.95);
    transition: opacity 0.3s ease, filter 0.3s ease;
}

.group-tab.dimmed:hover {
    opacity: 0.85;
    filter: saturate(0.8) brightness(0.98);
}

.group-tab.drag-over {
    background: rgba(102, 126, 234, 0.2);
    border: 1px dashed var(--accent-primary);
}

.group-tab.dragging {
    opacity: 0.5;
    cursor: grabbing;
}

.group-delete-btn {
    margin-left: 6px;
    margin-right: -6px;
    padding: 0 -4px 0 4px;
    background: transparent;
    border: none;
    border-radius: 50%;
    color: rgba(0, 0, 0, 0.3);
    font-size: 12px;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s ease, color 0.2s ease;
    -webkit-app-region: no-drag;
    line-height: 1;
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.group-tab:hover .group-delete-btn {
    opacity: 1;
}

.group-delete-btn:hover {
    color: #ef4444;
    background: rgba(239, 68, 68, 0.1);
}

.add-group-btn {
    width: 20px;
    height: 20px;
    border: none;
    border-radius: 4px;
    background: transparent;
    color: #999;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    margin-left: 2px;
    -webkit-app-region: no-drag;
}

.add-group-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #666;
}

.tabs-container {
    display: flex;
    align-items: center;
    padding: 8px 16px 0 16px;
    background: transparent;
    border-bottom: 1px solid var(--border-color);
    position: relative;
    /* For absolute positioning of settings button if needed */
}

.tabs {
    display: flex;
    flex: 1;
    gap: 2px;
    overflow-x: auto;
    align-items: flex-end;
    margin-right: 16px;
    /* Space for settings button */
}

.settings-btn {
    /* Reset previous positioning */
    position: static;
    transform: none;
    top: auto;
    right: auto;

    /* New positioning */
    background: transparent;
    border: none;
    color: #999;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    -webkit-app-region: no-drag;
    transition: all 0.2s ease;
    margin-left: auto;
    /* Push to the right */
    flex-shrink: 0;
}

.settings-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #333;
}

/* Remove previous conditional classes */
.settings-btn.centered-under-add,
.settings-btn.centered-under-sync {
    right: auto;
}

.tab {
    padding: 6px 8px;
    background: transparent;
    border-radius: 6px 6px 0 0;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    white-space: nowrap;
    transition: all 0.15s ease;
    color: var(--nav-item-text);
    border-bottom: 2px solid transparent;
    position: relative;
    -webkit-app-region: no-drag;
}

.tab.tab-colorized {
    border-bottom-width: 2px;
}

.tab.tab-colorized:not(.active) {
    border-bottom-color: var(--tab-color-inactive) !important;
}

.tab.tab-colorized.active {
    border-bottom-width: 4px;
    border-bottom-color: var(--tab-color-active) !important;
}

.tab.dragging {
    opacity: 0.5;
    cursor: grabbing;
}

.tab.drag-over {
    background: rgba(0, 0, 0, 0.05);
}

/* Task drop target styles */
.tab.task-drop-target {
    background: rgba(102, 126, 234, 0.15);
    border-bottom: 2px solid #667eea;
}

.tab.task-drop-incompatible {
    opacity: 0.4;
    cursor: not-allowed;
}

.tab.active {
    background: transparent;
    color: var(--text-primary);
    border-bottom-color: var(--text-primary);
}

.tab:hover:not(.active) {
    background: var(--hover-bg);
    color: var(--text-primary);
}

.tab-close {
    margin-left: 2px;
    margin-right: -12px;
    padding: 2px 6px;
    background: rgba(255, 255, 255, 0.2);
    border: none;
    border-radius: 50%;
    color: inherit;
    font-size: 12px;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s ease, color 0.2s ease, background 0.2s ease;
    -webkit-app-region: no-drag;
}

.tab:hover .tab-close {
    opacity: 0.7;
}

.tab-close:hover {
    opacity: 1 !important;
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.add-tab-btn-subtle {
    width: 24px;
    height: 24px;
    border: none;
    border-radius: 4px;
    background: transparent;
    color: #999;
    font-size: 18px;
    line-height: 1;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    margin-left: 2px;
    -webkit-app-region: no-drag;
    flex-shrink: 0;
    padding-top: 0;
    margin-bottom: 4px;
    transform: translateY(-2px);
}

.add-tab-btn-subtle:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #666;
}

/* Tasks Container */
.tasks-container {
    flex: 1 1 auto;
    padding: 16px 16px 0 16px;
    overflow-y: auto;
    position: relative;
    min-height: 0;
}

/* Task Item */
.task-item {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    position: relative;
    padding: 12px;
    margin-bottom: 8px;
    background: var(--task-bg);
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: all 0.2s ease;
    cursor: default;
}

.task-main-row {
    display: flex;
    align-items: center;
    width: 100%;
}

.notes-btn {
    background: transparent;
    border: none;
    color: var(--text-tertiary);
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.notes-btn:hover,
.notes-btn.active {
    background: var(--hover-bg);
    color: var(--text-secondary);
}

.notes-btn.has-notes {
    color: var(--text-secondary);
}

.notes-btn.has-notes:hover {
    color: var(--text-primary);
}

.notes-container {
    margin-top: 0;
    padding-top: 0;
    max-height: 0;
    overflow: hidden;
    transition: all 0.3s ease;
    opacity: 0;
}

.notes-container.open {
    margin-top: 8px;
    padding-top: 4px;
    max-height: 500px;
    /* Animate height */
    overflow: visible;
    opacity: 1;
}

.notes-editor-wrapper {
    background: var(--active-bg);
    /* Subtle light gray background */
    border: none;
    border-radius: 6px;
    overflow: visible;
    /* Allow done button to be visible */
    position: relative;
    /* For positioning the done button */
}

/* Custom Quill Styles */
.ql-toolbar.ql-snow {
    border: none !important;
    border-bottom: 1px solid var(--border-color-medium) !important;
    padding: 4px 8px !important;
    padding-right: 40px !important;
    /* Make room for done button */
    background: var(--active-bg);
    display: none;
    /* Hidden by default */
    position: relative;
    /* For absolute positioning of done button */
}

.notes-editor-wrapper.active .ql-toolbar.ql-snow {
    display: block;
    /* Show when active */
}

/* Done button - positioned on wrapper, only visible when active */
.notes-done-btn {
    position: absolute;
    right: 8px;
    top: 6px;
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    color: #64748b;
    /* Subtle dark grey */
    border-radius: 4px;
    cursor: pointer;
    display: none;
    /* Hidden by default */
    align-items: center;
    justify-content: center;
    z-index: 20;
}

.notes-editor-wrapper.active .notes-done-btn {
    display: flex;
    /* Show when wrapper is active */
}

.notes-done-btn:hover {
    color: #334155;
    /* Darker on hover */
    background: rgba(0, 0, 0, 0.05);
}

.ql-container.ql-snow {
    border: none !important;
    font-size: 14px !important;
    font-family: inherit !important;
}

.ql-editor {
    min-height: 60px;
    padding: 12px !important;
    color: var(--text-primary);
}

.ql-editor.ql-blank::before {
    color: var(--text-tertiary) !important;
    font-style: normal !important;
}

.task-item[draggable="true"] {
    cursor: grab;
}

.task-item.completed-task {
    background: var(--hover-bg);
}

.task-item:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-1px);
}

.task-item.dragging {
    opacity: 0.5;
    transform: rotate(5deg);
    cursor: grabbing;
}

/* Shrunk when hovering over a different tab */
.task-item.dragging.drag-over-tab {
    opacity: 0.3;
    transform: scale(0.5) rotate(5deg);
}

/* Placeholder for task being moved to a new tab - matches existing drag style */
.task-item.task-placeholder {
    opacity: 0.5;
}

.task-item.drag-over {
    border-top: 2px solid #667eea;
    margin-top: -2px;
}

/* Bottom drag target */
.bottom-drag-target {
    height: 12px;
    margin: 0 0 4px 0;
    border-radius: 4px;
    transition: all 0.2s ease;
    position: relative;
}

.bottom-drag-target.drag-over::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 12px;
    right: 12px;
    height: 2px;
    background: #667eea;
    border-radius: 1px;
    pointer-events: none;
}

/* Drag Handle */
.drag-handle {
    color: #ccc;
    font-size: 12px;
    cursor: grab;
    margin-right: 8px;
    user-select: none;
    -webkit-app-region: no-drag;
    pointer-events: none;
}

.drag-handle:hover {
    color: #999;
}

.task-checkbox {
    width: 18px;
    height: 18px;
    margin-right: 12px;
    cursor: pointer;
    appearance: none;
    border: 1px solid var(--border-color-medium);
    border-radius: 4px;
    background: var(--app-bg-solid);
    transition: all 0.15s ease;
    position: relative;
    flex-shrink: 0;
}

.task-checkbox:checked {
    background: var(--focus-btn-bg);
    border-color: var(--focus-btn-bg);
}

.task-checkbox:checked::after {
    content: '✓';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--focus-btn-text);
    font-size: 12px;
    font-weight: bold;
}

.task-checkbox:hover {
    border-color: var(--border-color-strong);
}

.task-checkbox:hover:not(:checked)::after {
    content: '✓';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-tertiary);
    font-size: 12px;
    font-weight: bold;
}

.task-checkbox:focus {
    outline: none;
    box-shadow: 0 0 0 2px hsl(214, 32%, 85%);
}

.task-text {
    flex: 1;
    font-size: 14px;
    line-height: 1.4;
    word-wrap: break-word;
}

.task-text.completed {
    text-decoration: line-through;
    opacity: 0.6;
}

.task-meta {
    font-size: 11px;
    color: #999;
    white-space: nowrap;
    flex-shrink: 0;
    cursor: pointer;
    padding: 0 4px;
    /* Make it clear it's interactive */
}

.task-meta.add-time {
    color: #ccc;
    font-weight: bold;
    padding: 0 4px;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.task-item:hover .task-meta.add-time {
    opacity: 1;
}

.task-meta.add-time:hover {
    color: #667eea;
}

.task-meta:hover {
    text-decoration: underline;
    /* Hint at editability */
}

.task-meta.actual-time {
    color: #999;
    /* Reset to default grey */
    font-weight: normal;
    cursor: pointer;
    /* Allow editing */
    text-decoration: none;
}

.task-meta.actual-time:hover {
    text-decoration: underline;
}

.task-edit-input {
    flex: 1;
    font-size: 14px;
    line-height: 1.4;
    padding: 0;
    margin: 0;
    border: none;
    background: transparent;
    font-family: inherit;
    color: inherit;
    outline: none;
    border-bottom: 1px solid #667eea;
    width: 100%;
    -webkit-app-region: no-drag;
    /* Textarea-specific styles */
    resize: none;
    overflow: hidden;
    min-height: 1.4em;
    /* Match line-height */
    display: block;
}

.task-actions {
    display: flex;
    gap: 2px;
    margin-left: auto;
    padding-left: 4px;
    flex-shrink: 0;
    align-items: center;
}

.hover-actions {
    display: none;
    gap: 0;
    align-items: center;
    position: relative;
}

.task-item:hover .hover-actions,
.task-item.has-open-menu .hover-actions {
    display: flex;
}

/* While a task menu is open, suppress hover actions for other rows. */
.task-menu-open .task-item:hover .hover-actions {
    display: none;
}

.task-menu-open .task-item.has-open-menu .hover-actions {
    display: flex;
}

.task-item.has-open-menu {
    z-index: 250;
}

/* Freeze hover-induced row motion while menu is open to prevent flicker. */
.task-menu-open .task-item:hover {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transform: none;
}

.task-menu-open .task-item:hover .task-meta.add-time {
    opacity: 0;
}

.always-actions {
    display: flex;
    gap: 2px;
    align-items: center;
}

.focus-btn,
.delete-btn,
.fav-btn {
    padding: 4px 8px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    min-width: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.focus-btn {
    background: hsl(222.2, 84%, 4.9%);
    border: 1px solid hsl(222.2, 84%, 4.9%);
    color: hsl(210, 40%, 98%);
    padding: 4px 2px;
    transition: all 0.15s ease;
}

/* Focus indicator for the currently focused task (main window) */
.focus-btn.active-focus {
    background: rgba(0, 0, 0, 0.08);
    border-color: rgba(0, 0, 0, 0.08);
    color: #e11d48;
    /* red */
}

.focus-btn.active-focus:hover {
    background: rgba(0, 0, 0, 0.12);
    border-color: rgba(0, 0, 0, 0.12);
    color: #be123c;
}

.focus-btn:hover {
    background: hsl(222.2, 84%, 9%);
    border-color: hsl(222.2, 84%, 9%);
}

.focus-btn svg {
    display: block;
}

.task-menu-btn {
    background: transparent;
    border: none;
    color: #999;
    padding: 4px;
    min-width: auto;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.task-menu-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #666;
}

/* Task context menu dropdown */
.task-menu {
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 100;
    min-width: 140px;
    padding: 4px;
    margin-top: 0;
}

.task-menu.hidden {
    display: none;
}

.task-menu-item {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 8px 12px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 13px;
    color: #374151;
    border-radius: 4px;
    text-align: left;
    transition: background 0.15s ease;
}

.task-menu-item:hover {
    background: #f3f4f6;
}

.task-menu-item.delete-task-item:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.task-menu-item svg {
    flex-shrink: 0;
}

.fav-btn {
    background: transparent;
    color: #d1d5db;
    /* Light gray */
    padding: 4px;
    min-width: 28px;
}

.fav-btn svg {
    transition: all 0.2s ease;
}

.fav-btn:hover {
    transform: scale(1.1);
    color: #9ca3af;
    /* Slightly darker on hover */
}

.fav-btn.active {
    color: #4b5563;
    /* Darker gray */
}

.fav-btn.active svg {
    fill: currentColor;
}


/* Add Task Container */
.add-task-container {
    display: flex;
    align-items: center;
    /* Ensure vertical centering */
    padding: 12px 16px 0px 16px;
    gap: 4px;
    flex-shrink: 0;
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.02);
    border-top: 1px solid var(--border-color);
    position: relative;
    z-index: 5;
}

.input-wrapper {
    flex: 1;
    display: flex;
    align-items: center;
    border: 2px solid var(--border-color-medium);
    border-radius: 8px;
    background: #ffffff;
    transition: border-color 0.2s ease;
    padding-right: 6px;
}

.input-wrapper:focus-within {
    border-color: var(--accent-primary);
}

#new-task-input {
    flex: 1;
    padding: 10px 12px;
    border: none;
    background: transparent;
    font-size: 14px;
    outline: none;
    border-radius: 8px 0 0 8px;
    color: var(--text-primary);
}

.duration-input-container {
    display: flex;
    align-items: center;
    width: 0;
    overflow: hidden;
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
    opacity: 0;
    white-space: nowrap;
    position: relative;
    /* Ensure icon is positioned relative to this */
}

.duration-input-container.visible {
    width: 28px;
    /* Collapsed width (icon only) */
    opacity: 1;
    margin-right: 4px;
}

.duration-input-container.visible:focus-within,
.duration-input-container.visible.has-value {
    width: 85px;
    /* Expanded width */
}

.duration-trigger-btn {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-tertiary);
    background: transparent;
    border: none;
    padding: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    border-radius: 4px;
    transition: opacity 0.2s ease, transform 0.2s ease, background 0.15s ease;
    z-index: 5;
}

.duration-trigger-btn:hover {
    color: var(--text-primary);
    background: rgba(0, 0, 0, 0.05);
}

.duration-trigger-btn.hidden {
    opacity: 0;
    pointer-events: none;
    transform: translate(-50%, -50%) scale(0.8);
}

.task-duration-input.hidden {
    display: none;
}

/* Ensure input is above icon but transparent */
.task-duration-input {
    z-index: 10;
    position: relative;
}

.task-duration-input,
#task-duration-input {
    flex: 1;
    min-width: 0;
    border: none;
    background: transparent;
    text-align: right;
    font-size: 13px;
    color: var(--text-primary);
    /* User wants black text when typing */
    outline: none;
    -moz-appearance: textfield;
    appearance: textfield;
    -webkit-app-region: no-drag;
}

.task-duration-input:placeholder-shown,
#task-duration-input:placeholder-shown {
    text-align: right;
    cursor: pointer;
}

/* Remove old placeholder styles since we use custom icon now */
.task-duration-input::placeholder,
#task-duration-input::placeholder {
    color: transparent;
}

.task-duration-input::-webkit-outer-spin-button,
.task-duration-input::-webkit-inner-spin-button,
#task-duration-input::-webkit-outer-spin-button,
#task-duration-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

.task-duration-edit.duration-input-container,
.task-duration-edit.duration-input-container.visible.has-value {
    display: inline-flex;
    vertical-align: middle;
    flex-shrink: 0;
    width: auto !important;
    /* Override the fixed 85px from .visible */
    margin-left: 4px;
    /* Match .task-meta spacing */
}

.task-duration-edit .task-duration-input {
    width: 28px;
    /* Compact width for existing tasks (just digits + m) */
    flex: none;
    text-align: right;
}

.duration-label {
    color: #999;
    font-size: 13px;
    margin-left: 0;
    width: 0;
    overflow: hidden;
    opacity: 0;
    /* Hidden by default (when showing placeholder) */
    transition: opacity 0.2s ease, width 0.2s ease, margin-left 0.2s ease;
}

.duration-input-container:focus-within .duration-label,
.duration-input-container.has-value .duration-label {
    width: 12px;
    margin-left: 2px;
    opacity: 1;
}

/* Duration Spinner Buttons */
.duration-spinners {
    display: flex;
    flex-direction: column;
    margin-left: 0;
    gap: 1px;
    width: 0;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease, width 0.2s ease, margin-left 0.2s ease;
}

.duration-input-container.visible:focus-within .duration-spinners,
.duration-input-container:focus-within .duration-spinners {
    width: 16px;
    margin-left: 2px;
    opacity: 1;
    pointer-events: auto;
}

.duration-spinner-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 12px;
    padding: 0;
    border: none;
    background: rgba(0, 0, 0, 0.06);
    border-radius: 3px;
    cursor: pointer;
    color: #666;
    transition: all 0.15s ease;
}

.duration-spinner-btn:hover {
    background: rgba(0, 0, 0, 0.12);
    color: #333;
}

.duration-spinner-btn:active {
    background: rgba(0, 0, 0, 0.18);
    transform: scale(0.95);
}

.duration-spinner-btn svg {
    display: block;
}

#add-task-btn {
    padding: 6px 12px;
    background: var(--accent-primary);
    border: none;
    border-radius: 6px;
    color: white;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-left: 8px;
    white-space: nowrap;
    opacity: 1;
    transform: scale(1);
}

#add-task-btn.hidden {
    display: none;
    opacity: 0;
    transform: scale(0.9);
}

#add-task-btn:hover {
    filter: brightness(1.1);
}

#add-task-btn:disabled {
    background: var(--border-color);
    cursor: not-allowed;
    color: var(--text-tertiary);
}

/* Scrollbar styling */
::-webkit-scrollbar {
    width: 0px;
    /* Hide vertical scrollbar */
    height: 4px;
    /* Make horizontal scrollbar thin */
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: var(--border-color-medium);
    border-radius: 2px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--border-color-strong);
}

/* Tabs specific scrollbar */
.tabs::-webkit-scrollbar {
    height: 0px;
    /* Hide horizontal scrollbar for tabs entirely */
}

/* Done Container */
.done-container {
    padding-top: 7px;
    padding-bottom: 8px;
    flex-shrink: 0;
    max-height: 120px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.done-heading {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0;
    padding: 0 16px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    display: flex;
    align-items: center;
    height: 24px;
    flex-shrink: 0;
    user-select: none;
}

.done-summary {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 16px 8px 16px;
    font-size: 12px;
    color: var(--text-tertiary);
}

.done-task-count {
    flex-shrink: 0;
}

.done-time-spent {
    flex: 1;
    text-align: center;
}

.done-toggle {
    display: flex;
    flex-direction: row-reverse;
    align-items: center;
    cursor: pointer;
    gap: 6px;
    padding: 4px 0;
}

.arrow-down-icon {
    display: flex;
    align-items: center;
    color: var(--text-tertiary);
}

.delete-all-btn {
    font-size: 12px;
    color: var(--text-tertiary);
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 4px 0;
    border-radius: 4px;
    transition: all 0.2s ease;
    font-weight: 500;
    flex-shrink: 0;
}

.delete-all-btn:hover {
    color: #ff4757;
}

.done-tasks {
    padding: 0 16px;
    position: relative;
    overflow-y: auto;
    min-height: 0;
    max-height: 100%;
}

/* Footer */
.footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 4px 16px 6px;
    font-size: 12px;
    color: var(--text-tertiary);
    z-index: 100;
    background: transparent;
}

.footer-text {
    flex: 1;
    text-align: center;
    font-size: 11px;
}

.settings-footer {
    flex-shrink: 0;
    display: flex;
    align-items: center;
}

.footer .heart {
    color: #ff4757;
    font-size: 14px;
}

.footer a {
    color: inherit;
    text-decoration: none;
    font-weight: normal;
}

.footer a:hover {
    text-decoration: underline;
}

/* Theme Toggle Icon Button */
.icon-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 4px 4px 0px 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-tertiary);
    transition: all 0.2s ease;
}

.icon-btn:hover {
    background: var(--hover-bg);
    color: var(--text-primary);
}

/* Modal Styles */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    backdrop-filter: blur(4px);
}

.modal-content {
    background: var(--modal-bg);
    border-radius: 12px;
    padding: 24px;
    width: 340px;
    min-width: 300px;
    max-width: 400px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.modal-content h3 {
    margin: 0 0 16px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
}

.settings-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
}

.settings-header h3 {
    margin: 0;
}

.settings-version {
    font-size: 12px;
    color: var(--text-tertiary);
    white-space: nowrap;
}

#tab-name-input {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid var(--border-color-medium);
    border-radius: 8px;
    font-size: 14px;
    outline: none;
    box-sizing: border-box;
    background: var(--input-bg);
    color: var(--text-primary);
}

#tab-name-input:focus {
    border-color: var(--accent-primary);
}

#export-buttons-container {
    margin-top: -4px;
}

.modal-buttons {
    display: flex;
    gap: 8px;
    margin-top: 16px;
    justify-content: flex-end;
}

.modal-btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.cancel-btn {
    background: var(--hover-bg);
    color: var(--text-secondary);
}

.cancel-btn:hover {
    background: var(--active-bg);
}

.create-btn {
    background: var(--focus-btn-bg);
    color: var(--focus-btn-text);
    border: 1px solid var(--focus-btn-bg);
}

.create-btn:hover {
    background: var(--accent-hover);
    border-color: var(--accent-hover);
}

.delete-confirm-btn {
    background: #ef4444;
    color: white;
    border: 1px solid #ef4444;
}

.delete-confirm-btn:hover {
    background: #dc2626;
    border-color: #dc2626;
}

/* Focus Mode Styles */
#focus-mode {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: transparent;
    /* Let container handle background */
    /* backdrop-filter: blur(10px); */
    /* Moved to container */
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    /* Remove any padding */
}

.hidden {
    display: none !important;
}

.focus-container {
    width: 100%;
    /* height: 100%;  -- Remove fixed height to allow growth with notes? 
       Actually, standard focus mode is fixed height window. 
       But we rely on app.js resizing the window. 
       So width 100% is fine. Height auto? 
       The window has specific height set by Electron. 
       If we set height: 100%, it fills the window. 
       If content grows, window grows (via IPC). 
       So height 100% is fine. */
    height: 100%;
    max-width: none;
    min-width: 0;
    background: var(--app-bg);
    backdrop-filter: blur(10px);
    border-radius: 0;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    padding: 0;
    box-shadow: none;
    border: none;
    position: relative;
    cursor: grab;
    transition: all 0.3s ease;
}

/* Rounded corners and styling for the focus panel window */
html.focus-panel-window {
    background: transparent;
    border-radius: 8px;
    overflow: hidden;
}

body.focus-panel-window {
    background: transparent;
    border-radius: 8px;
    overflow: hidden;
}

body.focus-panel-window .app-container {
    border-radius: 8px;
    overflow: visible;
}

body.focus-panel-window .focus-container {
    border-radius: 8px;
    overflow: visible;
}

/* In fullscreen mode, use solid background */
body.focus-panel-window.is-fullscreen .focus-container.fullscreen {
    border-radius: 0;
    background: var(--app-bg);
}

/* Ensure body covers entire viewport in fullscreen using class toggled by JS */
body.focus-panel-window.is-fullscreen {
    background: var(--app-bg) !important;
    border-radius: 0;
}

.focus-bar {
    width: 100%;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 14px;
    position: relative;
    flex-shrink: 0;
    -webkit-app-region: drag;
    user-select: none;
    -webkit-user-select: none;
}

/* Attention ring animation when focus mode opens */
.focus-container.attention-ring::after {
    content: '';
    position: absolute;
    inset: 0px;
    border-radius: 8px;
    pointer-events: none;
    box-sizing: border-box;
    border: 5px solid rgba(102, 126, 234, 0);
    opacity: 0;
    /* #667eea */
    animation: attentionRing 1200ms ease-out 1 forwards;
}

@keyframes attentionRing {
    0% {
        opacity: 0;
        border-color: rgba(102, 126, 234, 0);
        box-shadow: 0 0 0 0 rgba(102, 126, 234, 0);
    }

    15% {
        opacity: 1;
        border-color: rgba(102, 126, 234, 0.95);
        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.35);
    }

    70% {
        opacity: 0.6;
        border-color: rgba(102, 126, 234, 0.65);
        box-shadow: 0 0 0 6px rgba(102, 126, 234, 0.15);
    }

    100% {
        opacity: 0;
        border-color: rgba(102, 126, 234, 0);
        box-shadow: 0 0 0 10px rgba(102, 126, 234, 0);
    }
}

/* Add a specific class for windowed mode if needed to restore rounded corners/shadow 
   but user asked for focus-container to take up ALL space of focus mode window whatever size it is.
   Since the window itself is frameless and small in focus mode, we want the container to fill it. */

/* However, we might want to keep the max-width constraint for the content inside? 
   No, the request is "focus-container to take up ALL the space". */


.focus-container.fullscreen {
    width: 100vw !important;
    height: 100vh !important;
    max-width: none !important;
    border-radius: 0;
    box-shadow: none;
    border: none;
    flex-direction: column;
    justify-content: flex-start;
    gap: 0;
    background: var(--app-bg);
    position: relative;
}

.focus-container.fullscreen .focus-bar {
    flex: 1;
    height: auto;
    flex-direction: column;
    justify-content: center;
    padding: 0;
    transition: flex 0.2s ease;
}

.focus-container.fullscreen .focus-task-name {
    font-size: 48px;
    text-align: center;
    margin-right: 0;
    white-space: normal;

    /* Split screen layout */
    flex: 0 0 50%;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: center;
    padding-bottom: 20px;
    padding-left: 40px;
    padding-right: 40px;
}

.focus-container.fullscreen .focus-timer {
    font-size: 96px;
    text-align: center;
    width: 100%;
    margin: 0;
    opacity: 1 !important;
    /* Always show timer in fullscreen */

    /* Split screen layout */
    flex: 0 0 50%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    padding-top: 20px;
}

/* In fullscreen mode, dock button group near the bottom-right */
.focus-container.fullscreen .focus-buttons-container {
    top: auto;
    bottom: 40px;
    right: 40px;
    transform: none;
    padding: 10px 12px;
    gap: 10px;
    border-radius: 24px;
}

.focus-container.fullscreen .complete-focus-btn,
.focus-container.fullscreen .switch-focus-task-btn,
.focus-container.fullscreen .fullscreen-focus-btn,
.focus-container.fullscreen .reset-focus-btn,
.focus-container.fullscreen #notes-focus-btn,
.focus-container.fullscreen .exit-focus-btn {
    width: 48px;
    height: 48px;
}

.focus-container.fullscreen .complete-focus-btn svg,
.focus-container.fullscreen .switch-focus-task-btn svg,
.focus-container.fullscreen .fullscreen-focus-btn svg,
.focus-container.fullscreen .reset-focus-btn svg,
.focus-container.fullscreen #notes-focus-btn svg,
.focus-container.fullscreen .exit-focus-btn svg {
    width: 27px;
    height: 27px;
}

.focus-container.fullscreen .complete-focus-btn:hover,
.focus-container.fullscreen .switch-focus-task-btn:hover,
.focus-container.fullscreen .fullscreen-focus-btn:hover,
.focus-container.fullscreen .reset-focus-btn:hover,
.focus-container.fullscreen #notes-focus-btn:hover,
.focus-container.fullscreen .exit-focus-btn:hover {
    transform: scale(1.05);
}

/* Fullscreen notes container styling */
.focus-container.fullscreen .focus-notes-container {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: calc(50% + 160px);
    width: min(760px, calc(100vw - 80px));
    max-height: 50vh;
    overflow-y: auto;
    background: transparent;
    border: none;
    border-radius: 0;
    padding: 12px;
    box-shadow: none;
    z-index: 320;
}

.focus-container:active {
    cursor: default;
}

.focus-bar:hover .focus-timer {
    opacity: 0;
}

.focus-buttons-container {
    position: absolute;
    top: 50%;
    right: 14px;
    transform: translateY(-50%);
    display: flex;
    gap: 4px;
    padding: 4px;
    border-radius: 12px;
    background: var(--app-bg);
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
    -webkit-app-region: no-drag;
}

.focus-bar:hover .focus-buttons-container {
    opacity: 1;
    pointer-events: auto;
}

.complete-focus-btn,
.switch-focus-task-btn,
.fullscreen-focus-btn,
.reset-focus-btn,
.complete-focus-btn,
.notes-focus-btn,
.fullscreen-focus-btn,
.reset-focus-btn,
.exit-focus-btn {
    position: relative;
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 8px;
    background: var(--app-bg);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s ease, transform 0.15s ease;
    padding: 0;
    color: #666;
    -webkit-app-region: no-drag;
    outline: none;
}

.complete-focus-btn:focus,
.switch-focus-task-btn:focus,
.fullscreen-focus-btn:focus,
.reset-focus-btn:focus,
.complete-focus-btn:focus,
.notes-focus-btn:focus,
.fullscreen-focus-btn:focus,
.reset-focus-btn:focus,
.exit-focus-btn:focus {
    outline: none;
}

.complete-focus-btn {
    color: #16a34a;
}

.fullscreen-focus-btn {
    color: #667eea;
}

.reset-focus-btn {
    color: #f59e0b;
}

.switch-focus-task-btn {
    color: #475569;
}

.complete-focus-btn:hover,
.switch-focus-task-btn:hover,
.notes-focus-btn:hover,
.fullscreen-focus-btn:hover,
.reset-focus-btn:hover,
.exit-focus-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    transform: scale(1.05);
}

.focus-task-name {
    color: var(--text-primary);
    font-size: 18px;
    font-weight: 400;
    flex: 1;
    text-align: left;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: 8px;
    user-select: none;
    -webkit-user-select: none;
    -webkit-app-region: drag;
}

.focus-switch-task-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}

.focus-task-switch-menu {
    position: relative;
    width: min(100%, 400px);
    max-width: 400px;
    max-height: 720px;
    overflow-y: auto;
    background: var(--app-bg-solid);
    border: 1px solid var(--border-color-medium);
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);
    padding: 6px;
    margin: 6px 14px 0 auto;
    -webkit-app-region: no-drag;
}

.focus-container.fullscreen .focus-task-switch-menu {
    position: absolute;
    right: 40px;
    bottom: 104px;
    width: min(400px, calc(100vw - 80px));
    max-width: 400px;
    max-height: 50vh;
    margin: 0;
    z-index: 330;
}

.focus-task-switch-item {
    width: 100%;
    border: none;
    border-radius: 7px;
    background: transparent;
    color: var(--text-primary);
    text-align: left;
    font-size: 13px;
    line-height: 1.3;
    padding: 8px 10px;
    cursor: pointer;
    display: block;
    margin: 0;
}

.focus-task-switch-item:hover {
    background: var(--hover-bg);
}

.focus-task-switch-item.active {
    background: var(--active-bg);
    font-weight: 600;
}

.focus-task-switch-item.completed {
    opacity: 0.7;
    text-decoration: line-through;
}

.focus-task-name.completed {
    text-decoration: line-through;
    opacity: 0.6;
}

.focus-timer {
    font-size: 17px;
    font-weight: 550;
    color: var(--text-primary);
    text-align: right;
    -webkit-app-region: no-drag;
    flex-shrink: 0;
    width: auto;
    /* Allow timer to take only needed space */
    min-width: 70px;
    /* Minimum width to prevent jumping */
    margin-left: auto;
    transition: opacity 0.2s ease;
    user-select: none;
    -webkit-user-select: none;
    -webkit-app-region: drag;
}

/* Focus Mode Toast */
.focus-toast {
    position: absolute;
    left: 14px;
    /* Align with left padding */
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 6px 14px;
    border-radius: 6px;
    font-size: 13px;
    pointer-events: auto;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 12px;
}

.focus-toast.visible {
    opacity: 1;
}

#focus-undo-btn {
    background: var(--app-bg-solid);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
    font-weight: 500;
    font-size: 12px;
    cursor: pointer;
    padding: 4px 10px;
    border-radius: 4px;
    text-decoration: none;
    transition: all 0.2s ease;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
}

#focus-undo-btn:hover {
    background: var(--hover-bg);
    color: var(--text-primary);
    border-color: var(--border-color-medium);
}

/* Focus Mode Notes Button */
.notes-focus-btn {
    color: #64748b;
}

.notes-focus-btn.has-notes {
    color: #334155;
}

.notes-focus-btn.active {
    background: rgba(0, 0, 0, 0.08);
    color: #334155;
}

/* Focus Mode Notes Container */
.focus-notes-container {
    width: 100%;
    padding: 0 14px;
    background: var(--app-bg);
    margin-bottom: 0;
}

.focus-notes-container.hidden {
    display: none;
}

.focus-notes-editor-wrapper {
    background: var(--active-bg);
    border-radius: 6px;
    position: relative;
    -webkit-app-region: no-drag;
}



.focus-notes-editor-wrapper .ql-toolbar.ql-snow {
    display: none;
    border: none !important;
    border-bottom: 1px solid var(--border-color-medium) !important;
    padding: 4px 8px !important;
    padding-right: 40px !important;
    background: var(--active-bg);
    position: relative;
}

.focus-notes-editor-wrapper.active .ql-toolbar.ql-snow {
    display: block;
}

.focus-notes-editor-wrapper .ql-container.ql-snow {
    border: none !important;
    font-size: 14px !important;
}

.focus-notes-editor-wrapper .ql-editor {
    min-height: 20px;
    padding-bottom: 12px;
    max-height: 200px;
    overflow-y: auto;
    padding: 12px !important;
    color: var(--text-primary);
}

.focus-notes-editor-wrapper .notes-done-btn {
    display: none;
}

.focus-notes-editor-wrapper.active .notes-done-btn {
    display: flex;
}

.focus-timer.overtime {
    color: #ef4444;
}

/* Basecamp Settings */
.settings-section {
    margin-bottom: 24px;
}

.settings-section h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0;
    /* Removed default margin, controlled by parent layout */
}

.settings-desc {
    font-size: 13px;
    color: var(--text-secondary);
    margin-bottom: 16px;
}

.settings-desc a {
    color: #667eea;
    text-decoration: none;
}

.settings-desc a:hover {
    text-decoration: underline;
}

/* Info Toggle Button */
.info-toggle-btn {
    background: transparent;
    border: none;
    color: #999;
    cursor: pointer;
    padding: 4px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.info-toggle-btn:hover {
    color: var(--text-primary);
    background: var(--hover-bg);
}

.info-toggle-btn:focus {
    outline: none;
}

.info-toggle-btn[aria-expanded="true"] {
    color: #666;
}

/* Expandable Info Text */
.info-expandable {
    margin-top: 8px;
    margin-bottom: 12px;
    padding: 8px 12px;
    background: rgba(0, 0, 0, 0.03);
    border-radius: 6px;
    overflow: hidden;
    transition: all 0.2s ease;
}

.info-expandable.hidden {
    display: none;
}

.settings-input {
    width: 100%;
    padding: 8px;
    margin-bottom: 8px;
    border: 1px solid var(--border-color-medium);
    border-radius: 6px;
    font-size: 13px;
    background: var(--input-bg);
    color: var(--text-primary);
}

.settings-input:focus {
    border-color: #667eea;
    outline: none;
}

.help-text {
    font-size: 11px;
    color: #999;
    margin-top: 8px;
}

.help-text a {
    color: #667eea;
    text-decoration: none;
}

.help-text a:hover {
    text-decoration: underline;
}

.connect-btn {
    background: #2ecc71;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s ease;
    width: 100%;
}

.connect-btn:hover {
    background: #27ae60;
}

#oauth-connect-btn,
#connect-bc-btn {
    background-color: #ffe004;
    color: #333;
}

#oauth-connect-btn:hover,
#connect-bc-btn:hover {
    background-color: #e6c800;
}

.disconnect-btn {
    background: transparent;
    color: #ef4444;
    border: 1px solid #ef4444;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.disconnect-btn:hover {
    background: rgba(239, 68, 68, 0.1);
}

.connection-status {
    display: flex;
    align-items: center;
    font-size: 13px;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.status-dot {
    width: 8px;
    height: 8px;
    background: #2ecc71;
    border-radius: 50%;
    margin-right: 8px;
}

/* Basecamp Selection in Modal */
.basecamp-selection {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--border-color-medium);
}

.bc-label {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
    margin-bottom: 8px;
}

.bc-select {
    width: 100%;
    padding: 8px;
    border: 1px solid var(--border-color-medium);
    border-radius: 6px;
    font-size: 13px;
    margin-bottom: 8px;
    background: var(--input-bg);
    color: var(--text-primary);
}

.bc-select:focus {
    border-color: #667eea;
    outline: none;
}

/* Sync Button */
.sync-btn {
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    color: #999;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    margin-left: 8px;
}

.sync-btn:hover {
    color: #667eea;
    background: rgba(102, 126, 234, 0.1);
    border-radius: 4px;
}

.sync-btn.spinning svg {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

.sync-btn.disconnected {
    color: #e5a00d;
    position: relative;
}

.sync-btn.disconnected::after {
    content: '!';
    position: absolute;
    top: -2px;
    right: -2px;
    width: 12px;
    height: 12px;
    background: #e5a00d;
    color: white;
    font-size: 9px;
    font-weight: bold;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
}

.sync-btn.disconnected:hover {
    color: #c4870a;
    background: rgba(229, 160, 13, 0.1);
}

/* Resizer Handle */
.add-task-resizer {
    position: absolute;
    top: -6px;
    left: 0;
    right: 0;
    height: 12px;
    cursor: grab;
    z-index: 20;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.add-task-resizer:hover,
.add-task-resizer.dragging,
.add-task-container:hover .add-task-resizer,
#normal-mode:has(.done-container:hover) .add-task-resizer,
#normal-mode:has(.footer:hover) .add-task-resizer {
    opacity: 1;
}

/* Hide resizer when input is focused */
.add-task-container:has(.input-wrapper:focus-within) .add-task-resizer {
    opacity: 0 !important;
}

.add-task-resizer::after {
    content: '';
    width: 32px;
    height: 4px;
    background: var(--border-color-strong);
    border-radius: 2px;
}

/* Undo Toast */
.undo-toast {
    position: fixed;
    bottom: 32px;
    left: 50%;
    transform: translateX(-50%);
    background: #1f2937;
    /* Always dark for toast */
    color: #fff;
    padding: 12px 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 16px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    border: 1px solid var(--border-color-medium);
    z-index: 2000;
    font-size: 14px;
    animation: slideUp 0.3s ease;
}

.undo-toast.hidden {
    display: none;
}

@keyframes slideUp {
    from {
        transform: translate(-50%, 100%);
        opacity: 0;
    }

    to {
        transform: translate(-50%, 0);
        opacity: 1;
    }
}

.undo-btn {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    padding: 4px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
}

.undo-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.6);
}

.close-undo-btn {
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    font-size: 18px;
    cursor: pointer;
    padding: 0 4px;
    line-height: 1;
}

.close-undo-btn:hover {
    color: white;
}

/* Connect/Disconnect Buttons */
.connect-btn {
    background: var(--success);
    color: white;
    border: none;
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s ease;
    width: 100%;
}

.connect-btn:hover {
    filter: brightness(1.1);
}

/* Apple Reminders specific button style */
#reminders-connect-btn {
    background: var(--app-bg-solid);
    color: var(--text-primary);
    /* shadcn-like text color */
    border: 1px solid var(--border-color-strong);
    /* shadcn-like border color */
}

#reminders-connect-btn:hover {
    background: var(--hover-bg);
    /* shadcn-like hover bg */
}

.disconnect-btn {
    background: transparent;
    color: var(--danger);
    border: 1px solid var(--danger);
    padding: 8px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    margin-top: 4px;
    transition: all 0.2s ease;
    width: 100%;
}

.disconnect-btn:hover {
    background: rgba(239, 68, 68, 0.1);
}

/* Integrations spacing: tighten above and add breathing room below Reminders disconnect */
#disconnect-reminders-btn {
    margin-top: -2px;
    margin-bottom: 20px;
}

.manual-update-btn {
    position: relative;
    width: 36px;
    height: 36px;
    border: 1px solid var(--border-color-medium);
    border-radius: 8px;
    background: var(--app-bg-solid);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s ease, transform 0.15s ease;
    padding: 0;
    color: var(--text-tertiary);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.manual-update-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    transform: scale(1.05);
}

.focus-like-btn {
    background: hsl(222.2, 84%, 4.9%);
    color: hsl(210, 40%, 98%);
    border: 1px solid hsl(222.2, 84%, 4.9%);
}

.focus-like-btn:hover {
    background: hsl(222.2, 84%, 9%);
    border-color: hsl(222.2, 84%, 9%);
}

/* Basecamp Icon Dark Mode Fix */
[data-theme="dark"] .basecamp-icon {
    filter: brightness(0) invert(1);
}

/* Toggle Switch Styling */
.switch {
    position: relative;
    display: inline-block;
    width: 44px;
    height: 24px;
    flex-shrink: 0;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--border-color-strong);
    transition: .3s cubic-bezier(0.4, 0.0, 0.2, 1);
    border-radius: 24px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .3s cubic-bezier(0.4, 0.0, 0.2, 1);
    border-radius: 50%;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

input:checked+.slider {
    background-color: var(--accent-primary);
}

input:focus+.slider {
    box-shadow: 0 0 1px var(--accent-primary);
}

input:checked+.slider:before {
    transform: translateX(20px);
}

/* Tab Color Selection */
.tab-color-selection {
    margin-top: 16px;
    margin-bottom: 24px;
}

.color-swatches {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    align-items: center;
}

.color-swatch {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 1px solid var(--border-color);
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    padding: 0;
    position: relative;
    pointer-events: auto;
    z-index: 10;
}

.color-swatch:hover {
    transform: scale(1.1);
}

.color-swatch.selected {
    transform: scale(1.15);
    box-shadow: 0 0 0 2px var(--app-bg-solid), 0 0 0 4px var(--accent-primary);
    z-index: 11;
}

/* Default "None" swatch */
.color-swatch[data-color=""] {
    background: linear-gradient(to bottom right, transparent 45%, #ccc 45%, #ccc 55%, transparent 55%);
    background-color: var(--bg-secondary);
}

[data-theme="dark"] .color-swatch[data-color=""] {
    background: linear-gradient(to bottom right, transparent 45%, #666 45%, #666 55%, transparent 55%);
    background-color: var(--bg-secondary);
}

/* Custom color swatch */
.color-swatch-custom {
    background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
}

.color-swatch-custom svg {
    color: white;
    filter: drop-shadow(0 0 1px rgba(0, 0, 0, 0.5));
    pointer-events: none;
}

#custom-color-input {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
    width: 100%;
    height: 100%;
    border: 0;
    padding: 0;
}



/* Tab Border Colors (for grouped mode - bottom border only) */
.tab.tab-border-red {
    border-bottom-color: #FF9E9E !important;
}

.tab.tab-border-orange {
    border-bottom-color: #FFC09F !important;
}

.tab.tab-border-yellow {
    border-bottom-color: #FFEE93 !important;
}

.tab.tab-border-green {
    border-bottom-color: #ADF7B6 !important;
}

.tab.tab-border-blue {
    border-bottom-color: #81B1D1 !important;
}

.tab.tab-border-purple {
    border-bottom-color: #B19CD9 !important;
}

.tab.tab-border-pink {
    border-bottom-color: #FFD1DC !important;
}

.tab.tab-border-gray {
    border-bottom-color: #A0CED9 !important;
}

/* Tab Background Colors */
.tab.tab-bg-red {
    background-color: #FF9E9E;
    border-color: #FF9E9E;
    color: #7f1d1d;
}

.tab.tab-bg-orange {
    background-color: #FFC09F;
    border-color: #FFC09F;
    color: #7c2d12;
}

.tab.tab-bg-yellow {
    background-color: #FFEE93;
    border-color: #FFEE93;
    color: #713f12;
}

.tab.tab-bg-green {
    background-color: #ADF7B6;
    border-color: #ADF7B6;
    color: #14532d;
}

.tab.tab-bg-blue {
    background-color: #81B1D1;
    border-color: #81B1D1;
    color: #1e3a8a;
}

.tab.tab-bg-purple {
    background-color: #B19CD9;
    border-color: #B19CD9;
    color: #581c87;
}

.tab.tab-bg-pink {
    background-color: #FFD1DC;
    border-color: #FFD1DC;
    color: #831843;
}

.tab.tab-bg-gray {
    background-color: #A0CED9;
    border-color: #A0CED9;
    color: #0f4a5a;
}

/* Dark Mode Overrides for Tabs */
[data-theme="dark"] .tab.tab-bg-red {
    background-color: #B86A6A;
    border-color: #D88A8A;
    color: #FF9E9E;
}

[data-theme="dark"] .tab.tab-bg-orange {
    background-color: #B88A6A;
    border-color: #D8A07F;
    color: #FFC09F;
}

[data-theme="dark"] .tab.tab-bg-yellow {
    background-color: #B8A85A;
    border-color: #D8C873;
    color: #FFEE93;
}

[data-theme="dark"] .tab.tab-bg-green {
    background-color: #6BA87A;
    border-color: #8BC89A;
    color: #ADF7B6;
}

[data-theme="dark"] .tab.tab-bg-blue {
    background-color: #4A6B8A;
    border-color: #6B9BA8;
    color: #81B1D1;
}

[data-theme="dark"] .tab.tab-bg-purple {
    background-color: #7A6BA8;
    border-color: #9A8BC8;
    color: #B19CD9;
}

[data-theme="dark"] .tab.tab-bg-pink {
    background-color: #B88A9A;
    border-color: #D8A1B1;
    color: #FFD1DC;
}

[data-theme="dark"] .tab.tab-bg-gray {
    background-color: #5B8A9A;
    border-color: #7BA8B8;
    color: #A0CED9;
}

/* Ensure active tab overrides still work/blend - but usually active tab has its own strong style. 
   We probably want color tabs to KEEP their color even when active, maybe just bolder border? 
   Or let active style (white/dark bg) take precedence? 
   Let's let active style take precedence for consistency, but maybe keep the color hint? 
   Actually user probably wants the whole tab colored.
   
   Let's try overriding active style for colored tabs.
*/
.tab.active.tab-bg-red,
.tab.active.tab-bg-orange,
.tab.active.tab-bg-yellow,
.tab.active.tab-bg-green,
.tab.active.tab-bg-blue,
.tab.active.tab-bg-purple,
.tab.active.tab-bg-pink,
.tab.active.tab-bg-gray {
    /* Keep default active border logic but add background? */
    /* If we want them to feel "selected", maybe a slightly lighter/darker shade? 
      For now let's just use the defined colors. */
    border-bottom-color: transparent;
    /* Match general active tab rule */
    font-weight: 600;
}

/* Group Tab Background Colors - mirror the tab colors */
.group-tab.tab-bg-red {
    background-color: #FF9E9E;
    border-color: #FF9E9E;
    color: #7f1d1d;
}

.group-tab.tab-bg-orange {
    background-color: #FFC09F;
    border-color: #FFC09F;
    color: #7c2d12;
}

.group-tab.tab-bg-yellow {
    background-color: #FFEE93;
    border-color: #FFEE93;
    color: #713f12;
}

.group-tab.tab-bg-green {
    background-color: #ADF7B6;
    border-color: #ADF7B6;
    color: #14532d;
}

.group-tab.tab-bg-blue {
    background-color: #81B1D1;
    border-color: #81B1D1;
    color: #1e3a8a;
}

.group-tab.tab-bg-purple {
    background-color: #B19CD9;
    border-color: #B19CD9;
    color: #581c87;
}

.group-tab.tab-bg-pink {
    background-color: #FFD1DC;
    border-color: #FFD1DC;
    color: #831843;
}

.group-tab.tab-bg-gray {
    background-color: #A0CED9;
    border-color: #A0CED9;
    color: #0f4a5a;
}

/* Dark Mode Overrides for Group Tabs */
[data-theme="dark"] .group-tab.tab-bg-red {
    background-color: #B86A6A;
    border-color: #D88A8A;
    color: #FF9E9E;
}

[data-theme="dark"] .group-tab.tab-bg-orange {
    background-color: #B88A6A;
    border-color: #D8A07F;
    color: #FFC09F;
}

[data-theme="dark"] .group-tab.tab-bg-yellow {
    background-color: #B8A85A;
    border-color: #D8C873;
    color: #FFEE93;
}

[data-theme="dark"] .group-tab.tab-bg-green {
    background-color: #6BA87A;
    border-color: #8BC89A;
    color: #ADF7B6;
}

[data-theme="dark"] .group-tab.tab-bg-blue {
    background-color: #4A6B8A;
    border-color: #6B9BA8;
    color: #81B1D1;
}

[data-theme="dark"] .group-tab.tab-bg-purple {
    background-color: #7A6BA8;
    border-color: #9A8BC8;
    color: #B19CD9;
}

[data-theme="dark"] .group-tab.tab-bg-pink {
    background-color: #B88A9A;
    border-color: #D8A1B1;
    color: #FFD1DC;
}

[data-theme="dark"] .group-tab.tab-bg-gray {
    background-color: #5B8A9A;
    border-color: #7BA8B8;
    color: #A0CED9;
}

/* Active group tabs with colors */
.group-tab.active.tab-bg-red,
.group-tab.active.tab-bg-orange,
.group-tab.active.tab-bg-yellow,
.group-tab.active.tab-bg-green,
.group-tab.active.tab-bg-blue,
.group-tab.active.tab-bg-purple,
.group-tab.active.tab-bg-pink,
.group-tab.active.tab-bg-gray {
    font-weight: 600;
}

/* Dimmed group tabs with colors - ensure colors are properly muted */
/* The general .group-tab.dimmed rule applies, but we ensure colored tabs also respect it */
.group-tab.dimmed.tab-bg-red,
.group-tab.dimmed.tab-bg-orange,
.group-tab.dimmed.tab-bg-yellow,
.group-tab.dimmed.tab-bg-green,
.group-tab.dimmed.tab-bg-blue,
.group-tab.dimmed.tab-bg-purple,
.group-tab.dimmed.tab-bg-pink,
.group-tab.dimmed.tab-bg-gray {
    /* Inherits opacity and filter from .group-tab.dimmed, but ensure it applies */
    opacity: 0.5;
    filter: saturate(0.6) brightness(0.95);
}

[data-theme="dark"] .group-tab.dimmed.tab-bg-red,
[data-theme="dark"] .group-tab.dimmed.tab-bg-orange,
[data-theme="dark"] .group-tab.dimmed.tab-bg-yellow,
[data-theme="dark"] .group-tab.dimmed.tab-bg-green,
[data-theme="dark"] .group-tab.dimmed.tab-bg-blue,
[data-theme="dark"] .group-tab.dimmed.tab-bg-purple,
[data-theme="dark"] .group-tab.dimmed.tab-bg-pink,
[data-theme="dark"] .group-tab.dimmed.tab-bg-gray {
    opacity: 0.5;
    filter: saturate(0.6) brightness(0.95);
}